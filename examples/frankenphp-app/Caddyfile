{
	frankenphp
	order go_handler before file_server
}

:8080

@is_bad_origin {
    header Origin *
    not header Origin http://localhost:8080
}

@go_paths path /ws /internal/broadcast

handle @go_paths {
    abort @is_bad_origin
    
    go_handler {
        broadcast_secret "a-very-strong-and-secret-key-for-broadcast"
        driver redis
        redis_address localhost:6379
        # auth_endpoint http://localhost:8080/auth.php
    }
}

php_server